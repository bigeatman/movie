<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE mapper PUBLIC '-//mybatis.org//DTD Mapper 3.0//EN'
	'http://mybatis.org/dtd/mybatis-3-mapper.dtd'>
<mapper namespace='com.my.movie.dao.map.UserMap'>
	<select id='selectUserLogin' resultType='user'>
		select *
		from users
		where user_id = #{userId} and pw = #{pw}
	</select>
	
	<select id='selectWithDrawal' resultType='_int'>
		select count(*)
		from users, user_withdrawal 
		where users.user_num = #{userNum} and user_withdrawal.user_num = #{userNum}
	</select>
	
	<select id='selectUser' resultType='user'>
		select *
		from users
		where user_id = #{userId}
	</select>
	
	<select id='selectUserId' resultType='int'>
		select count(*)
		from users
		where user_id = #{userId}
	</select>
	
	<select id='selectUserPw' resultType='userDto'>
		select pw
		from users
		where pw = #{pw}
	</select>
	
	<select id='selectUserNickname' resultType='int'>
		select count(*)
		from users
		where nickname = #{nickname}
	</select>
	
	<select id='selectUserPhoneNum' resultType='int'>
		select count(*)
		from users
		where phone_num = #{phoneNum}
	</select>
	
	<select id='selectUserEmail' resultType='int'>
		select count(*)
		from users
		where email = #{email}
	</select>
	
	<insert id='insertUser' keyProperty="userNum" useGeneratedKeys="true">
		insert into users(user_num, user_id, pw, nickname, phone_num, email)
		values(user_num_seq.nextval, #{userId}, #{pw}, #{nickname}, #{phoneNum}, #{email})
	</insert>
	
	<insert id='insertUserGenre'>
		insert into user_genre(user_num, genre_num)
		values(user_num_seq.nextval, #{genreNum})
	</insert>

	<insert id='insertWithDrawal'>
		insert into user_WITHDRAWAL(user_num)
		values(#{userNum})
	</insert>

<!-- Àç¿ø -->
	<select id='selectId1' resultType='string'>
		select user_id
		from users
		where email = #{email} and phone_num = #{phoneNum}
	</select>
	
	<select id='selectPw1' resultType='string'>
		select user_id, email
		from users
		where user_id = #{userId} and email = #{email}
	</select>
	
	<update id='updatePw1'>
		update users
		set pw = #{pw}
		where user_id = #{userId}
	</update>
</mapper>